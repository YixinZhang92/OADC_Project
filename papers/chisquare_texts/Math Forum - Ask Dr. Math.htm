
<!-- saved from url=(0051)http://mathforum.org/library/drmath/view/63765.html -->
<html class="gr__mathforum_org"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Math Forum - Ask Dr. Math</title>

<meta name="title" content="Orthogonal Distance Regression Planes">

<meta name="description" content="I have a set of data points that I have collected from an experiment. 
I want to fit a 3D plane (best-fit) into these points (the points are 
in the form (x1,y1,z1), (x2,y2,z2),...) in order to evaluate my 
results.">

<meta name="author" content="R.P.">

<meta name="date" content="07/30/2003">
</head>

<body bgcolor="#FFFFFF" data-gr-c-s-loaded="true">

<!-- Snippet begins -->
<!-- /var/www/html/snippets/drexel_top.drmath -->


<center>
<p><nobr>
  <img border="0" src="./Math Forum - Ask Dr. Math_files/drexel_line4.jpg" alt="The Math Forum">
</nobr></p>
</center>
<!-- /var/www/html/snippets/drexel_top.drmath -->
<!-- Snippet ends -->


<center><img src="./Math Forum - Ask Dr. Math_files/dr.mathQA.gif" alt="Ask Dr. Math - Questions and Answers from our Archives">
</center>
<center>
<img src="./Math Forum - Ask Dr. Math_files/forum.blueline.gif" alt="_____________________________________________"><br>

<a href="http://mathforum.org/library/drmath/view/63765.html#assoc">Associated Topics</a> ||
<a href="http://mathforum.org/dr.math/">Dr. Math Home</a> ||
<a href="http://mathforum.org/library/drmath/view/63765.html#search">Search Dr. Math</a><br>

<img src="./Math Forum - Ask Dr. Math_files/forum.blueline.gif" alt="_____________________________________________"><br>

<br>
<table width="580" border="0">
<tbody><tr>
<td>

<h3>Orthogonal Distance Regression Planes</h3>

<pre>Date: 07/30/2003 at 12:30:04
From: R.P.
Subject: Fitting a plane into a set of points

I have a set of data points that I have collected from an experiment. 
I want to fit a 3D plane (best-fit) into these points (the points are 
in the form (x1,y1,z1), (x2,y2,z2),...) in order to evaluate my 
results. I know doing this calculation is not going to be easy. 
However, I want to see the approach so i can get an idea. Even a link 
to a website that can help would be enough.
</pre>
<hr>
<pre>
Date: 07/30/2003 at 13:12:45
From: Doctor George
Subject: Re: Fitting a plane into a set of points

Hi R.P.,

Thanks for writing to Doctor Math.

There are different kinds of best fit planes. One best fit plane 
minimizes the maximum distance from the points to the plane. Another 
minimizes the sum of squared distances to the plane.

Actually, it gets more complex than that. For the least squares plane, 
there is one kind in which the x and y values are fixed, and the 
measured error is in z alone. This is called a regression plane. For 
this plane the minimized distance is only in the z direction. There is 
also a orthogonal distance regression plane that minimizes the 
perpendicular distances to the plane. This is used when there is 
measurement error in all three coordinates.

Does this help you pin down what kind of best fit you are looking 
for? We can get into some details once we get this sorted out.

- Doctor George, The Math Forum
  <a href="http://mathforum.org/dr.math/">http://mathforum.org/dr.math/</a> 
</pre>
<hr>
<pre>
Date: 07/30/2003 at 13:22:38
From: R.P.
Subject: Fitting a plane into a set of points

Thanks for the quick reply. The type of best fit I am interested in 
is orthogonal distance regression planes.
</pre>
<hr>
<pre>
Date: 07/30/2003 at 14:03:01
From: Doctor George
Subject: Re: Fitting a plane into a set of points

Hi R.P.,

Finding the orthogonal distance regression plane is an eigenvector 
problem. It is quite involved, as you suspected. The best solution 
utilizes the Singular Value Decomposition (SVD). I hope you have 
access to a good linear algebra software package.

Starting with the distance from a point to a plane, we wish to find 
a, b, c and d such that we minimize

  f(a,b,c,d) = Sum [|axi + byi + czi + d|^2 / (a^2 + b^2 + c^2)]

If we set the partial derivative with respect to d equal to zero, we 
can solve for d to get

        d = -(a*x0 + b*y0 + c*z0)

where (x0, y0, z0) is the centroid of the data. This means that the 
least squares plane contains the centroid. If we substitute it back 
into the equation for the plane we get

        a(x - x0) + b(y - y0) + c(z - z0) = 0

We can rewrite f(a,b,c,d) like this

  f(a,b,c) = Sum [|a(xi-x0) + b(yi-y0) + c(zi-z0)|^2 / (a^2+b^2+c^2)]

Now we are going to switch over to a matrix representation. I will 
be using both the upper and lower cases of some letters. I hope that 
does not cause confusion.

Let's define v and M such that

             T
            v  = [a  b  c]

                 --                             --
                 | x1 - x0    y1 - y0    z1 - z0 |
                 | x2 - x0    y2 - y0    z2 - z0 |
            M =  |    .          .          .    |
                 |    .          .          .    |
                 |    .          .          .    |
                 | xn - x0    yn - y0    zn - z0 |
                 --                             --

If you multiply the matrices out, you will see that f(a,b,c) becomes

               T T          T
      f(v) = (v M )(Mv) / (v v)

              T  T        T
           = v (M M)v / (v v)

                  T
Let's define A = M M, which when divided by the number of data points 
becomes the covariance matrix of the data.

f(v) is called a Rayleigh Quotient. It is minimized by the eigenvector 
of A that corresponds to its smallest eigenvalue.

We could compute the eigenvectors of A, but this is not needed. The 
SVD of M is
                    T
             M = USV 

where S is a diagonal matrix containing the singular values of M, the 
columns of V are its singular vectors, and U is an orthogonal matrix.

                    T
Now            A = M M

                       T T    T
                 = (USV ) (USV )

                       T T      T
                 = (V S U ) (USV )

                      2 T 
                 = V S V

This decomposition of A diagonalizes the matrix and provides an 
eigenvector decomposition. It means that the eigenvalues of A are the 
squares of the singular values of M, and the eigenvectors of A are the 
singular vectors of M.

To conclude, the orthogonal least squares 3D plane contains the 
centroid of the data, and its normal vector is the singular vector of 
M corresponding to its smallest singular value.

Does this give you enough to go on? Write again if you need more 
help.

- Doctor George, The Math Forum
  <a href="http://mathforum.org/dr.math/">http://mathforum.org/dr.math/</a> 

</pre>
<hr>
<pre>Date: 06/29/2005 at 18:41:25
From: Russ
Subject: Best Fit Plane for a set of points

I have read your excellent answer.  In it you state that, "If we 
set the partial derivative with respect to d equal to zero, we can 
solve for d to get d = -(ax0 + by0 + cz0) where (x0,y0,z0) is the
centroid of the data.  This means that the least squares plane contains
the centroid."

When I take the partial derivative I get d = -(axi + byi + czi) but 
I can not see why this leads to the conclusion that this is the 
centroid. 
               
It seems logical that this would be true, however I would like to 
know why does the best fit plane HAVE to contain the centroid?  I am 
doing some work with best fit planes and have even solved some 
problems using your article.  However my coworkers are very skeptical 
of what I am doing and I'd like to convince them this is in fact true.  

</pre>
<hr>
<pre>Date: 06/30/2005 at 08:04:41
From: Doctor George
Subject: Re: Best Fit Plane for a set of points

Hi Russ,

Thanks for writing to Doctor Math. I'm glad that you found my article
to be helpful.

   f(a,b,c,d) = Sum [|axi + byi + czi + d|^2 / (a^2 + b^2 + c^2)]

I'll use p for partial derivative since the text character set does
not contain the usual symbol for partial derivative.

   pf/pd = 2 Sum [(axi + byi + czi + d) / (a^2 + b^2 + c^2)] = 0

leads to

           Sum (axi + byi + czi + d) = 0

           a Sum xi + b Sum yi + c Sum zi + Nd = 0

where N is the number of points. Now we continue,

           Nd = -(a Sum xi + b Sum yi + c Sum zi)

           d = -(a Sum xi + b Sum yi + c Sum zi) / N

           d = -[a (Sum xi)/N + b (Sum yi)/N + c (Sum zi)/N]

           d = -(a*x0 + b*y0 + c*z0)

Does that make sense? Write again if you need more help.

- Doctor George, The Math Forum
  <a href="http://mathforum.org/dr.math/">http://mathforum.org/dr.math/</a> 
</pre>

</td>
</tr>
</tbody></table>
</center>

<center>
<a name="assoc"><b>Associated Topics</b>:</a><br>




<a href="http://mathforum.org/library/drmath/sets/college_linearalg.html">College Linear Algebra</a><br>
<a href="http://mathforum.org/library/drmath/sets/college_statistics.html">College Statistics</a><br>
</center>
<p>

<a name="search"></a>
<table align="center" border="0" cellpadding="4" cellspacing="0">
<tbody><tr>
<td align="center"><a name="search"><p><img src="./Math Forum - Ask Dr. Math_files/forum.greenline.gif"></p></a>
<p align="center"><font size="4" color="#33CC33"><b>Search the Dr. Math Library:</b></font></p>
</td>
</tr>
 <tr>
  <td>
        <form action="http://mathforum.org/library/drmath/results.html" method="get">                 

    <table align="center" border="0" cellpadding="3" cellspacing="1">
        <tbody><tr>
        <td colspan="4">
<center><nobr>
</nobr></center><br>
                Find items containing (put spaces between keywords):<br>
                        <input type="TEXT" name="textsearch" size="50" value="">
&nbsp; 
<br>
<b><font color="red">Click only once for faster results:</font></b>
                        <input type="SUBMIT" value="SEARCH" valign="middle"><br>
<p>
                <font size="-1">[ Choose "whole words" when searching for a word
 like <i>age.</i>]</font>
     </p></td>
    </tr>
    <tr>
      <td colspan="4">
 <center><nobr>

       <input type="radio" name="textsearch_bool_type" value="and" checked="">all keywords, in any order
<input type="radio" name="textsearch_bool_type" value="or">at least one,
<input type="radio" name="textsearch_bool_type" value="phrase">that exact phrase

        <br>

        <input type="radio" name="textsearch_whole_words" value="no" checked="">parts of words 
<input type="radio" name="textsearch_whole_words" value="yes">whole words 

</nobr></center>
        <p>
       </p></td>
      </tr>
      <tr>
       <td align="center" valign="middle" colspan="4">
         <center>
          <p> 
       </p></center></td>
      </tr>

</tbody></table>

</form></td></tr></tbody></table>




</p><center>
<b><a href="http://mathforum.org/dr.math/ask.html">Submit your own question to Dr. Math</a></b>

<p>[<b><a href="http://mathforum.org/announce/privacy.html">Privacy Policy</a></b>]
[<b><a href="http://mathforum.org/announce/terms.html">Terms of Use</a></b>]</p>

<img src="./Math Forum - Ask Dr. Math_files/forum.blueline(1).gif" alt="_____________________________________"><br>

<a href="http://mathforum.org/">Math Forum Home</a>  ||

<a href="http://mathforum.org/library/">Math Library</a> ||

<a href="http://mathforum.org/special.html">Quick Reference</a> ||

<a href="http://mathforum.org/grepform.html">Math Forum Search</a>

<br>

<img src="./Math Forum - Ask Dr. Math_files/forum.blueline(1).gif" alt="_____________________________________"><p>

<font size="-1">Ask Dr. Math</font><font size="1"><sup>TM</sup></font><br>
<font size="-1">© 1994-<script type="text/javascript" async="" src="./Math Forum - Ask Dr. Math_files/_Incapsula_Resource"></script><script>document.write(new Date().getFullYear())</script>2019 The Math Forum at NCTM. All rights reserved.<br>
http://mathforum.org/dr.math/<br></font>

</p></center>


<p>
<script type="text/javascript">
//<![CDATA[
(function() {
var _analytics_scr = document.createElement('script');
_analytics_scr.type = 'text/javascript'; _analytics_scr.async = true; _analytics_scr.src = '/_Incapsula_Resource?SWJIYLWA=719d34d31c8e3a6e6fffd425f7e032f3&ns=1&cb=1605134896';
var _analytics_elem = document.getElementsByTagName('script')[0]; _analytics_elem.parentNode.insertBefore(_analytics_scr, _analytics_elem);
})();
// ]]>
</script>





</p></body><span class="gr__tooltip"><span class="gr__tooltip-content"></span><i class="gr__tooltip-logo"></i><span class="gr__triangle"></span></span></html>